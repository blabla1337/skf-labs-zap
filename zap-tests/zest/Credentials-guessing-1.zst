{
  "about": "This is a Zest script. For more details about Zest visit http://github.com/zaproxy/zest/",
  "zestVersion": "0.3",
  "title": "Credentials-guessing-1",
  "description": "A template standalone script",
  "prefix": "",
  "type": "StandAlone",
  "parameters": {
    "tokenStart": "{{",
    "tokenEnd": "}}",
    "tokens": {},
    "elementType": "ZestVariables"
  },
  "statements": [
    {
      "set": {
        "start": 0,
        "end": 45,
        "step": 1,
        "elementType": "ZestLoopTokenIntegerSet"
      },
      "statements": [
        {
          "url": "http://localhost:4444/login",
          "data": "username\u003d12345\u0026password\u003d{{password}}",
          "method": "POST",
          "headers": "Content-Type: application/x-www-form-urlencoded\r\nContent-Length: 29\r\nOrigin: http://localhost:4444\r\nDNT: 1\r\nSec-Fetch-Dest: document\r\nSec-Fetch-Mode: navigate\r\nSec-Fetch-Site: same-origin\r\nSec-Fetch-User: ?1\r\n",
          "response": {
            "url": "http://localhost:4444/login",
            "headers": "HTTP/1.0 200 OK\nContent-Type: text/html; charset\u003dutf-8\nContent-Length: 5014\nServer: Werkzeug/2.0.3 Python/3.7.8\nDate: Wed, 25 May 2022 14:38:09 GMT\n\n",
            "body": "",
            "statusCode": 200,
            "responseTimeInMs": 5,
            "elementType": "ZestResponse"
          },
          "assertions": [
            {
              "rootExpression": {
                "code": 200,
                "not": false,
                "elementType": "ZestExpressionStatusCode"
              },
              "elementType": "ZestAssertion"
            }
          ],
          "followRedirects": false,
          "timestamp": 1653489489042,
          "cookies": [],
          "index": 1,
          "enabled": true,
          "elementType": "ZestRequest"
        },
        {
          "rootExpression": {
            "value": "25",
            "variableName": "looper",
            "caseExact": false,
            "not": false,
            "elementType": "ZestExpressionEquals"
          },
          "ifStatements": [
            {
              "rootExpression": {
                "greaterThan": false,
                "timeInMs": 2000,
                "not": false,
                "elementType": "ZestExpressionResponseTime"
              },
              "ifStatements": [
                {
                  "message": "No throtteling detected against brute force",
                  "priority": "HIGH",
                  "index": 6,
                  "enabled": true,
                  "elementType": "ZestActionFail"
                }
              ],
              "elseStatements": [],
              "index": 5,
              "enabled": true,
              "elementType": "ZestConditional"
            }
          ],
          "elseStatements": [],
          "index": 2,
          "enabled": true,
          "elementType": "ZestConditional"
        }
      ],
      "variableName": "looper",
      "index": 1,
      "enabled": true,
      "elementType": "ZestLoopInteger"
    },
    {
      "set": {
        "tokens": [
          "password",
          "iloveyou",
          "princess",
          "1234567",
          "rockyou",
          "12345678",
          "abc123",
          "nicole",
          "babygirl",
          "monkey",
          "lovely",
          "jessica",
          "654321",
          "michael",
          "ashley",
          "qwerty",
          "111111",
          "iloveu",
          "000000",
          "michelle",
          "tigger",
          "sunshine",
          "chocolate",
          "password1",
          "soccer",
          "12345"
        ],
        "elementType": "ZestLoopTokenStringSet"
      },
      "statements": [
        {
          "url": "http://localhost:4444/login",
          "data": "username\u003d{{fuzzer}}\u0026password\u003d{{fuzzer}}",
          "method": "POST",
          "headers": "Content-Type: application/x-www-form-urlencoded\r\nContent-Length: 29\r\nOrigin: http://localhost:4444\r\nDNT: 1\r\r\nSec-Fetch-Dest: document\r\nSec-Fetch-Mode: navigate\r\nSec-Fetch-Site: same-origin\r\nSec-Fetch-User: ?1\r\n",
          "response": {
            "url": "http://localhost:4444/login",
            "headers": "HTTP/1.0 200 OK\nContent-Type: text/html; charset\u003dutf-8\nContent-Length: 5014\nServer: Werkzeug/2.0.3 Python/3.7.8\nDate: Wed, 25 May 2022 14:38:09 GMT\n\n",
            "body": "",
            "statusCode": 200,
            "responseTimeInMs": 5,
            "elementType": "ZestResponse"
          },
          "assertions": [
            {
              "rootExpression": {
                "code": 200,
                "not": false,
                "elementType": "ZestExpressionStatusCode"
              },
              "elementType": "ZestAssertion"
            }
          ],
          "followRedirects": false,
          "timestamp": 1653489489042,
          "cookies": [],
          "index": 2,
          "enabled": true,
          "elementType": "ZestRequest"
        },
        {
          "rootExpression": {
            "regex": "\\QSet-Cookie: session\u003d\\E",
            "variableName": "response.header",
            "caseExact": false,
            "not": false,
            "elementType": "ZestExpressionRegex"
          },
          "ifStatements": [
            {
              "message": "Guessable user account detected",
              "priority": "HIGH",
              "index": 3,
              "enabled": true,
              "elementType": "ZestActionFail"
            }
          ],
          "elseStatements": [],
          "index": 2,
          "enabled": true,
          "elementType": "ZestConditional"
        }
      ],
      "variableName": "fuzzer",
      "index": 1,
      "enabled": true,
      "elementType": "ZestLoopString"
    }
  ],
  "authentication": [],
  "index": 0,
  "enabled": true,
  "elementType": "ZestScript"
}